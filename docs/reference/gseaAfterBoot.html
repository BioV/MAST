<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gene set analysis for hurdle model — gseaAfterBoot • MAST</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">MAST</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RGLab/MAST/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gene set analysis for hurdle model</h1>
    </div>

    
    <p>Modules defined in <code>sets</code> are tested for average differences in expression from the &quot;average&quot; gene.
By using bootstraps, the between-gene covariance of terms in the hurdle model is found, and is used to adjust for coexpression between genes.
We drop genes if the coefficient we are testing was not estimible in original model fit in <code>zFit</code> or in any of the bootstrap replicates (evidenced an <code>NA</code> in the bootstrap array).  This might yield overly conservative inference.
Since bootstrapping is a randomized procedure, the degrees of freedom of a module (and its variance parameters) might differ from run-to-run.
You might try setting <code>var_estimate=&#39;modelbased&#39;</code> to relax this requirement by assuming independence between genes and then using the asymptotic covariance estimates, which are deterministic, but may result in overly-generous inference.</p>
    

    <pre><span class='fu'>gseaAfterBoot</span>(<span class='no'>zFit</span>, <span class='no'>boots</span>, <span class='no'>sets</span>, <span class='no'>hypothesis</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>n_randomize</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>var_estimate</span> <span class='kw'>=</span> <span class='st'>"bootall"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>zFit</dt>
      <dd>object of class ZlmFit</dd>
      <dt>boots</dt>
      <dd>bootstraps of zFit</dd>
      <dt>sets</dt>
      <dd>list of indices of genes</dd>
      <dt>hypothesis</dt>
      <dd>a <code>Hypothesis</code> to test. Currently only one degree <code>CoefficientHypothesis</code> are supported.</dd>
      <dt>control</dt>
      <dd>list of control parameters.  See details.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code>GSEATests</code>, containing slots <code>tests</code>,  4D array and <code>bootR</code>, the number of boostrap replicates.</p>
    
    <h2 class="hasAnchor" id="-code-control-code-"><a class="anchor" href="#-code-control-code-"></a>&lt;code&gt;control&lt;/code&gt;</h2>

    <p></p>
    <p><code>control</code> is a list with elements:
<ul>
<li> <code>n_randomize</code>, giving the number of genes to sample to approximate the non-module average expression. Set to <code>Inf</code> to turn off the approximation (the default).
</li>
<li> <code>var_estimate</code>, giving the method used to estimate the variance of the modules.  <code>bootall</code> uses the bootstrapped covariance matrices.  <code>bootdiag</code> uses only the diagonal of the bootstrapped covariance matrix (so assuming independence across genes). <code>modelbased</code> assumes independence across genes and uses the variance estimated from the model.</li>
</ul></p>
    
    <h2 class="hasAnchor" id="return-value"><a class="anchor" href="#return-value"></a>Return Value</h2>

    <p></p>
    <p>A 4D array is returned, with  dimensions &quot;set&quot; (each module), &quot;comp&quot; (&#39;disc&#39;rete or &#39;cont&#39;inuous), &quot;metric&quot; (&#39;stat&#39; gives the average of the coefficient, &#39;var&#39; gives the variance of that average, &#39;dof&#39; gives the number of genes that were actually tested in the set), &quot;group&quot; (&#39;test&#39; for the genes in test-set, &quot;null&quot; for all genes outside the test-set).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='calcZ.html'>calcZ</a></p>
    <p>summary,GSEATests-method</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>vbetaFA</span>)
<span class='no'>vb1</span> <span class='kw'>=</span> <span class='fu'>subset</span>(<span class='no'>vbetaFA</span>, <span class='no'>ncells</span><span class='kw'>==</span><span class='fl'>1</span>)
<span class='no'>vb1</span> <span class='kw'>=</span> <span class='no'>vb1</span>[,<span class='fu'><a href='freq.html'>freq</a></span>(<span class='no'>vb1</span>)<span class='kw'>&gt;</span><span class='fl'>.1</span>][<span class='fl'>1</span>:<span class='fl'>15</span>,]
<span class='no'>zf</span> <span class='kw'>=</span> <span class='fu'><a href='zlm.html'>zlm</a></span>(~<span class='no'>Stim.Condition</span>, <span class='no'>vb1</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Done!</span></div><div class='input'><span class='no'>boots</span> <span class='kw'>=</span> <span class='fu'><a href='bootVcov1.html'>bootVcov1</a></span>(<span class='no'>zf</span>, <span class='fl'>5</span>)
<span class='no'>sets</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>A</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>3</span>:<span class='fl'>10</span>, <span class='kw'>C</span><span class='kw'>=</span><span class='fl'>15</span>, <span class='kw'>D</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>5</span>)
<span class='no'>gsea</span><span class='kw'>=</span><span class='fu'>gseaAfterBoot</span>(<span class='no'>zf</span>, <span class='no'>boots</span>, <span class='no'>sets</span>, <span class='fu'><a href='Hypothesis.html'>CoefficientHypothesis</a></span>(<span class='st'>'Stim.ConditionUnstim'</span>))
<span class='fu'><a href='calcZ.html'>calcZ</a></span>(<span class='no'>gsea</span>)</div><div class='output co'>#&gt; , , metric = Z
#&gt; 
#&gt;    comp
#&gt; set       cont      disc
#&gt;   A -0.9327106 -1.066283
#&gt;   B -0.4801646 -3.406370
#&gt;   C        NaN -3.584276
#&gt;   D -0.9327106 -1.066283
#&gt; 
#&gt; , , metric = P
#&gt; 
#&gt;    comp
#&gt; set      cont        disc
#&gt;   A 0.3855052 0.329922269
#&gt;   B 0.6533250 0.009277177
#&gt;   C       NaN 0.009531795
#&gt;   D 0.3855052 0.329922269
#&gt; </div><div class='input'><span class='fu'>summary</span>(<span class='no'>gsea</span>)</div><div class='output co'>#&gt;    set     cont_Z    cont_P    disc_Z      disc_P combined_Z combined_P
#&gt; 1:   C        NaN       NaN -3.584276 0.009531795 -2.4530273 0.04525634
#&gt; 2:   B -0.4801646 0.6533250 -3.406370 0.009277177 -1.5241897 0.17900212
#&gt; 3:   A -0.9327106 0.3855052 -1.066283 0.329922269 -0.8061226 0.44410544
#&gt; 4:   D -0.9327106 0.3855052 -1.066283 0.329922269 -0.8061226 0.44410544
#&gt;    cont_effect disc_effect combined_adj
#&gt; 1:         NaN  -1.4281950    0.1810254
#&gt; 2:  -0.3898317  -1.2768804    0.3580042
#&gt; 3:  -0.6142811  -0.3488222    0.4441054
#&gt; 4:  -0.6142811  -0.3488222    0.4441054</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#-code-control-code-">&lt;code&gt;control&lt;/code&gt;</a></li>

      <li><a href="#return-value">Return Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Andrew McDavid, Greg Finak, Masanao Yajima.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
